(defnode main)

(defloop play-files
  (Audio.Device) ; just for testing
  (Audio.ReadFile "../../external/file_example_OOG_1MG.ogg" :From 1.0 :To 1.023219954648526)
  (Log))

(schedule main play-files)
(run main)
(schedule main play-files)
(run main)

(defloop play-file-fft
  (Audio.ReadFile "../../external/file_example_OOG_1MG.ogg" :Channels 1 :From 5.0 :To 6.0)
  (DSP.FFT) = .freq-domain
  (DSP.IFFT :Audio true)
  (Audio.WriteFile "example-fft.wav" :Channels 1)
  .freq-domain (DSP.IFFT :Complex true) (DSP.FFT) ; FOR COVERAGE
  .freq-domain (DSP.IFFT :Complex false)
  (Math.Normalize :Positive true)
  (FloatsToImage 32 32 1) (WritePNG "example.wav.png") ; again, just for coverage
  (Log))

(schedule main play-file-fft)
(run main)

;; (defloop play-file-dwt
;;   (Audio.ReadFile "../../external/file_example_OOG_1MG.ogg" :Channels 1 :From 5.0 :To 6.0)
;;   (DSP.Wavelet)
;;   (DSP.InverseWavelet)
;;   (Audio.WriteFile "example-dwt.wav" :Channels 1))

;; (schedule main play-file-dwt)
;; (run main)

;; WIP
;; (defloop sine-rt
;;   (Audio.Device)
;;   440.0 = .hz
;;   (Audio.Channel
;;    ; no inputs
;;    :Outputs [0 1] ; L R of bus 0 (default)
;;    :Volume 0.5
;;    :Contents
;;    (->
;;     ; this runs at a different pace then the parent loop
;;     ; specifically runs in the audio real time thread
;;     ; pauses are not allowed in fact
;;     ; shared variables are syncronized behind the scene
;;     ; in fact they are copies
;;     .hz (Audio.SineWave))))